<div id="inner_content">
<div class="modal-header">
    <button type="button" class="close" id="modal_close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Закрыть</span></button>
    <h3 class="modal-title" id="lineModalLabel">{% block title %}{{ title }}{% endblock %}</h3>
</div>
<div class="modal-body">
    {% block form %}
        <form method="POST" action="{{ action_url }}" id="modal_form">
            {% csrf_token %}
            {{ form.errors }}
            {% for item in form %}
            <div class="form-group">
                <label>{{ item.label }}</label>
                {{ item }}
            </div>
            {% endfor %}
            {% if deletable %}
            <input type="hidden" name="delete" value="false" id="deletable">
            {% endif %}
        </form>
    {% endblock %}
</div>
<div class="modal-footer">
    <div class="btn-group btn-group-justified" role="group" aria-label="group button">
        {% if deletable %}
        <div class="btn-group btn-delete" role="group">
            <button type="button" id="modal_delete" class="btn btn-default btn-hover-red" data-dismiss="modal"  role="button">{% block delete %}Удалить{% endblock %}</button>
        </div>
        {% endif %}
        <div class="btn-group" role="group">
            <button type="button" id="modal_save" class="btn btn-default btn-hover-green" data-action="save" role="button">{% block save %}Сохранить{% endblock %}</button>
        </div>
    </div>
</div>
</div>
{% block script %}
<script>
    $("#modal_form").submit(function(e) {
    var url = $("#modal_form").attr('action');

    $.ajax({
           type: "POST",
           url: url,
           data: $("#modal_form").serialize(), // serializes the form's elements.
           success: function(data)
           {
               $('#inner_content').parent().html(data)
               $('#modal_close').click()
           }
         });

        e.preventDefault(); // avoid to execute the actual submit of the form.
    });
    $("#modal_save").on("click", function(){
        $("#modal_form").submit()
    });
    {% if deletable %}
    $("#modal_delete").on("click", function(){
        $("#deletable").val(true)
        $("#modal_form").submit()
    });
    {% endif %}
</script>
{% endblock %}